{"version":3,"sources":["/Users/thejameskyle/git/marionette/backbone-metal/src/backbone-metal.js"],"names":[],"mappings":"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","file":"backbone-metal.min.js","sourcesContent":["(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(['backbone', 'underscore'], factory);\n  } else if (typeof exports !== 'undefined') {\n    module.exports = factory(require('backbone'), require('underscore'));\n  } else {\n    factory(root.Backbone, root._);\n  }\n})(this, function(Backbone, _) {\n  'use strict';\n  \n  var _slice = Array.prototype.slice;\n\n  /**\n   * @module Metal\n   */\n  var Metal = {};\n  \n  /**\n   * Wraps the passed method so that `this._super` will point to the superMethod\n   * when the method is invoked.\n   *\n   * @private\n   * @method wrap\n   * @param {Function} method - The method to call.\n   * @param {Function} superMethod - The super method.\n   * @return {Function} - wrapped function.\n   */\n  function wrap(method, superMethod) {\n    return function() {\n      var prevSuper = this._super;\n      this._super = superMethod;\n      var ret = method.apply(this, arguments);\n      this._super = prevSuper;\n      return ret;\n    };\n  }\n  \n  /**\n   * A reference to safe regex for checking if a function calls `_super`.\n   *\n   * @private\n   * @const {RegExp}\n   */\n  var superTest = (/xyz/.test(function(){return 'xyz';})) ? /\\b_super\\b/ : /.*/;\n  \n  /**\n   * Assigns properties of source object to destination object, wrapping methods\n   * that call their super method.\n   *\n   * @private\n   * @method wrapAll\n   * @param {Object} dest - The destination object.\n   * @param {Object} source - The source object.\n   */\n  function wrapAll(dest, source) {\n    _.forEach(source, function(method, name) {\n      var superMethod = dest[name];\n      var hasSuper = superTest.test(method);\n  \n      if (hasSuper && _.isFunction(method) && _.isFunction(superMethod)) {\n        dest[name] = wrap(method, superMethod);\n      } else {\n        dest[name] = method;\n      }\n    });\n  }\n  \n  /**\n   * Creates a new Class.\n   *\n   * @public\n   * @class Class\n   * @memberOf Metal\n   * @memberOf Backbone\n   */\n  var Class = Metal.Class = Backbone.Class = function() {\n    this.initialize.apply(this, arguments);\n  };\n  \n  /**\n   * An overridable method called when objects are instantiated. Does not do\n   * anything by default.\n   *\n   * @public\n   * @abstract\n   * @method initialize\n   */\n  Class.prototype.initialize = _.noop;\n  \n  _.extend(Class, {\n  \n    /**\n     * Creates a new subclass.\n     *\n     * @public\n     * @static\n     * @method extend\n     * @param {Object} [protoProps] - The properties to be added to the prototype.\n     * @param {Object} [staticProps] - The properties to be added to the constructor.\n     */\n    extend(protoProps, staticProps) {\n      var Parent = this;\n      var Child;\n  \n      if (protoProps && _.has(protoProps, 'constructor')) {\n        Child = wrap(protoProps.constructor, Parent.prototype.constructor);\n      } else {\n        Child = function() { Parent.apply(this, arguments); };\n      }\n  \n      _.extend(Child, Parent);\n      wrapAll(Child, staticProps);\n  \n      var Surrogate = function() { this.constructor = Child; };\n      Surrogate.prototype = Parent.prototype;\n      Child.prototype = new Surrogate();\n  \n      wrapAll(Child.prototype, protoProps);\n  \n      Child.superclass = Parent;\n      Child.__super__ = Parent.prototype;\n  \n      return Child;\n    },\n  \n    /**\n     * Mixes properties onto the class's prototype.\n     *\n     * @public\n     * @static\n     * @method mixin\n     * @param {Object} protoProps - The properties to be added to the prototype.\n     * @return {Class} - The class.\n     */\n    mixin(protoProps) {\n      wrapAll(this.prototype, protoProps);\n      return this;\n    },\n  \n    /**\n     * Mixes properties onto the class's constructor.\n     *\n     * @public\n     * @static\n     * @method mixin\n     * @param {Object} protoProps - The properties to be added to the constructor.\n     * @return {Class} - The class.\n     */\n    include(staticProps) {\n      wrapAll(this, staticProps);\n      return this;\n    }\n  });\n  \n  /**\n   * Allows you to create mixins, whose properties can be added to other classes.\n   *\n   * @public\n   * @class Mixin\n   * @memberOf Metal\n   * @memberOf Backbone\n   * @param {Object} protoProps - The properties to be added to the prototype.\n   */\n  var Mixin = Metal.Mixin = Backbone.Mixin = function(protoProps) {\n    _.extend(this, protoProps);\n  };\n  \n  /**\n   * @private\n   * @const {String[]}\n   */\n  var errorProps = [\n    'description', 'fileName', 'lineNumber', 'name', 'message', 'number'\n  ];\n  \n  /**\n   * A subclass of the JavaScript Error object for use in Backbone. Can also add\n   * a url based on\n   *\n   * @class Error\n   * @memberOf Metal\n   * @extends Error\n   * @uses Metal.Class\n   */\n  var Err = Metal.Error = Backbone.Error = Class.extend.call(Error, {\n  \n    /**\n     * @property {String} urlRoot - The root url to be used in the error message.\n     */\n    urlRoot: 'http://github.com/thejameskyle/backbone-metal',\n  \n    /**\n     * @public\n     * @constructs Error\n     * @param {String} [message] - A description of the error.\n     * @param {Object} [options] - Settings for the error.\n     * @param {String} [options.message] - A description of the error.\n     * @param {String} [options.url] - The url to visit for more help.\n     */\n    constructor(message, options = {}) {\n      if (_.isObject(message)) {\n        options = message;\n        message = options.message;\n      }\n  \n      var error = Error.call(this, message);\n      _.extend(this, _.pick(error, errorProps), _.pick(options, errorProps));\n  \n      this.captureStackTrace();\n  \n      if (options.url) {\n        this.url = this.urlRoot + options.url;\n      }\n    },\n  \n    /**\n     * A safe reference to V8's `Error.captureStackTrace`.\n     *\n     * @public\n     * @method captureStackTrace\n     */\n    captureStackTrace() {\n      if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, Err);\n      }\n    },\n  \n    /**\n     * Formats the error message to display in the console.\n     *\n     * @public\n     * @method toString\n     * @returns {String} - Formatted error message.\n     */\n    toString() {\n      return this.name + ': ' + this.message + (\n        this.url ? ' See: ' + this.url : ''\n      );\n    }\n  });\n  \n  /**\n   * @class Error\n   * @mixes Class\n   */\n  _.extend(Err, Class);\n  \n  /**\n   * Display a deprecation warning with the provided message.\n   *\n   * @public\n   * @method deprecate\n   * @param {String|Object} message - A description of the deprecation.\n   * @param {String} message.prev - The deprecated item.\n   * @param {String} message.next - The replacement for the deprecated item.\n   * @param {String} [message.url] - The url to visit for more help.\n   * @param {Boolean} [test] - An optional boolean. If falsy, the deprecation will be displayed.\n   */\n  var deprecate = Metal.deprecate = Backbone.deprecate = function(message, test) {\n    if (test !== undefined && test) {\n      return;\n    }\n  \n    if (_.isObject(message)) {\n      message = deprecate._format(message.prev, message.next, message.url);\n    }\n  \n    message = message && message.toString();\n  \n    if (!deprecate._cache[message]) {\n      deprecate._warn('Deprecation warning: ' + message);\n      deprecate._cache[message] = true;\n    }\n  };\n  \n  /**\n   * Format a message for deprecate.\n   *\n   * @private\n   * @method _format\n   * @memberOf deprecate\n   * @param {String} prev - The deprecated item.\n   * @param {String} next - The replacement for the deprecated item.\n   * @param {String} [url] - The url to visit for more help.\n   * @return {Sring} - The formatted message.\n   */\n  deprecate._format = function(prev, next, url) {\n    return (\n      prev + ' is going to be removed in the future. ' +\n      'Please use ' + next + ' instead.' +\n      (url ? ' See: ' + url : '')\n    );\n  };\n  \n  /**\n   * A safe reference to `console.warn` that will fallback to `console.log` or\n   * `_noop` if the `console` object does not exist.\n   *\n   * @private\n   * @method _warn\n   * @memberOf deprecate\n   * @param {*...} - The values to warn in the console.\n   */\n  if (typeof console !== 'undefined') {\n    deprecate._warn = console.warn || console.log;\n  }\n  \n  if (!deprecate._warn) {\n    deprecate._warn = _.noop;\n  }\n  \n  /**\n   * An internal cache to avoid sending the same deprecation warning multiple\n   * times.\n   *\n   * @private\n   * @property _cache\n   * @memberOf deprecate\n   */\n  deprecate._cache = {};\n  \n  /**\n   * A `Metal.Mixin` version of `Backbone.Events`.\n   *\n   * @mixin Events\n   * @memberOf Metal\n   * @memberOf Backbone\n   * @extends Metal.Mixin\n   * @mixes Backbone.Events\n   */\n  var Events = Metal.Events = Backbone.Events = new Mixin(Backbone.Events);\n  \n  \n  /**\n   * @class Class\n   * @mixes Events\n   */\n  Class.mixin(Events);\n  \n  /**\n   * Split the event name on the \":\"\n   *\n   * @private\n   * @const {RegExp}\n   */\n  var triggerSplitter = /(^|:)(\\w)/gi;\n  \n  /**\n   * Take the event section (\"section1:section2:section3\") and turn it in to\n   * uppercase name.\n   *\n   * @private\n   * @method getEventName\n   * @param {String} match - The matched substring.\n   * @param {Number} offset - The offset of the matched substring within the total string being examined.\n   * @param {String} eventName - The event name.\n   * @return {String} - The uppercase event name.\n   */\n  function getEventName(match, offset, eventName) {\n    return eventName.toUpperCase();\n  }\n  \n  /**\n   * A set of utility functions to be mixed into any class. Already mixed into\n   * `Metal.Class`.\n   *\n   * @mixin Utils\n   * @memberOf Metal\n   * @memberOf Backbone\n   * @extends Metal.Mixin\n   */\n  var Utils = Metal.Utils = Backbone.Utils = new Mixin({\n  \n    /**\n     * @public\n     * @method triggerMethod\n     * @param {String} event - The name of the event.\n     * @param {*...} args - The arguments to pass to the method and trigger.\n     * @return {*} - The result of the method.\n     */\n    triggerMethod(event, ...args) {\n      var methodName = 'on' + event.replace(triggerSplitter, getEventName);\n      var method = this[methodName];\n      var result;\n  \n      if (_.isFunction(method)) {\n        result = method.apply(this, args);\n      }\n  \n      if (_.isFunction(this.trigger)) {\n        this.trigger.apply(this, arguments);\n      }\n  \n      return result;\n    },\n  \n    /**\n     * @public\n     * @method getOption\n     * @param {String} name - The name of the option to get.\n     * @returns {*} - The value of the option.\n     */\n    getOption(name) {\n      if (this.options && this.options[name] !== undefined) {\n        return this.options[name];\n      } else {\n        return this[name];\n      }\n    }\n  });\n  \n  /**\n   * @class Class\n   * @mixes Utils\n   */\n  Class.mixin(Utils);\n  \n  _.mixin({\n  \n    /**\n     * Checks if `value` is a class.\n     *\n     * @public\n     * @method isClass\n     * @memberOf _\n     * @param {*} value - The value to check.\n     */\n    isClass: function(value) {\n      return !!value && value.prototype instanceof Class;\n    },\n  \n    /**\n     * Checks if `value` is a mixin.\n     *\n     * @public\n     * @method isMixin\n     * @memberOf _\n     * @param {*} value - The value to check.\n     */\n    isMixin: function(value) {\n      return !!value && value instanceof Mixin;\n    }\n  });\n  \n  return Metal;\n});\n"],"sourceRoot":"/source/"}